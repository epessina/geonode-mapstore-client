"use strict";(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[84922],{977597:(e,t,r)=>{r.d(t,{Z:()=>u});var n=r(558422),o=r.n(n),a=r(507412),l=r(805346);function i(e){var t=e.msgId,r=e.icon;return o().createElement("div",{className:"gn-main-event-container"},o().createElement("div",{className:"gn-main-event-content"},o().createElement("div",{className:"gn-main-event-text"},o().createElement("div",{className:"gn-main-icon"},o().createElement(a.Z,{name:r})),t&&o().createElement(l.Z,{msgId:t}))))}i.defaultProps={msgId:"",icon:"exclamation"};const u=i},818534:(e,t,r)=>{r.d(t,{Z:()=>b});var n=r(558422),o=r.n(n),a=r(375875),l=r(23279),i=r.n(l),u=r(743129),c=r(993451),f=["loadOptions","pageSize","debounceTime"];function m(){return m=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},m.apply(null,arguments)}function s(e){return function(e){if(Array.isArray(e))return p(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||v(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,l,i=[],u=!0,c=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(i.push(n.value),i.length!==t);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=r.return&&(l=r.return(),Object(l)!==l))return}finally{if(c)throw o}}return i}}(e,t)||v(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(e,t){if(e){if("string"==typeof e)return p(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?p(e,t):void 0}}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var y=(0,c.Z)("placeholder")(u.ZP);const b=function(e){var t=e.loadOptions,r=e.pageSize,l=void 0===r?20:r,u=e.debounceTime,c=void 0===u?500:u,v=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.includes(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.includes(r)||{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,f),p=d((0,n.useState)(""),2),b=p[0],g=p[1],h=d((0,n.useState)(!1),2),O=h[0],E=h[1],S=d((0,n.useState)(!1),2),j=S[0],w=S[1],P=d((0,n.useState)(!1),2),Z=P[0],I=P[1],k=d((0,n.useState)(1),2),C=k[0],N=k[1],A=d((0,n.useState)([]),2),x=A[0],T=A[1],D=(0,n.useRef)(),F=(0,n.useRef)(),q=(0,n.useRef)();return q.current=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(){var e;D.current&&(null===(e=D.current)||void 0===e||e.cancel(),D.current=void 0);var t=a.Z.CancelToken;D.current=t.source()}();var r=e.q,n=null!=r?r:b;E(!0);var o=e.page||C;t({q:n,page:o,pageSize:l,config:{cancelToken:D.current.token}}).then((function(e){var t=e.results.map((function(e){return e.selectOption}));T(1===o?t:[].concat(s(x),s(t))),w(e.isNextPageAvailable),E(!1),D.current=void 0})).catch((function(){T([]),w(!1),E(!1),D.current=void 0}))},(0,n.useEffect)((function(){F.current=i()((function(e){e!==b&&(g(e),N(1),T([]),q.current({q:e,page:1}))}),c)}),[]),(0,n.useEffect)((function(){Z&&(g(""),N(1),T([]),q.current({q:"",page:1}))}),[Z]),(0,n.useEffect)((function(){C>1&&q.current()}),[C]),o().createElement(y,m({},v,{isLoading:O,options:x,onOpen:function(){return I(!0)},onClose:function(){return I(!1)},filterOptions:function(e){return e},onInputChange:function(e){return t=e,D.current&&(null===(r=D.current)||void 0===r||r.cancel(),D.current=void 0),F.current.cancel(),void F.current(t);var t,r},onMenuScrollToBottom:function(){!O&&j&&N(C+1)}}))}},84922:(e,t,r)=>{r.r(t),r.d(t,{default:()=>X});var n=r(558422),o=r.n(n),a=r(774717),l=r(204852),i=r(271418),u=r(529089),c=r(805346),f=r(99159);var m=r(416790),s=(0,n.lazy)((function(){return Promise.all([r.e(82515),r.e(95755)]).then(r.bind(r,795755))}));const d={SelectWidget:function(e){return o().createElement(f.Z,e)},TextareaWidget:function(e){var t=e.id,r=e.options,a=void 0===r?{}:r,l=e.value,i=e.onChange;return null!=a&&a["geonode-ui:richTextEditor"]?o().createElement(n.Suspense,{fallback:null},o().createElement(s,{id:t,value:l,onChange:i})):o().createElement(m.Z,e)}};var v=r(512295),p=r(693473),y=r(507412),b=r(697111),g=r(993451),h=["onChange","value","debounceTime"];function O(){return O=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},O.apply(null,arguments)}var E=(0,g.Z)("placeholder")(i.NI);const S=(0,b.Z)("onChange","value")((function(e){var t=e.onChange,r=e.value,n=(e.debounceTime,function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.includes(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.includes(r)||{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,h));return o().createElement(E,O({},n,{value:r,onChange:function(e){return t(e.target.value)}}))}));function j(e){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},j(e)}function w(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?w(Object(r),!0).forEach((function(t){Z(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Z(e,t,r){return(t=function(e){var t=function(e){if("object"!=j(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=j(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==j(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function I(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,a,l,i=[],u=!0,c=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=a.call(r)).done)&&(i.push(n.value),i.length!==t);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=r.return&&(l=r.return(),Object(l)!==l))return}finally{if(c)throw o}}return i}}(e,t)||k(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e,t){if(e){if("string"==typeof e)return C(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?C(e,t):void 0}}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var N=function(e){var t=document.querySelector("[for=".concat(e,"]"))||document.getElementById(e);t&&t.scrollIntoView({behavior:"smooth",block:"start"})};function A(e){var t=e.idSchema,r=e.title,a=e.group,l=e.expanded,u=I((0,n.useState)(!1),2),c=u[0],f=u[1],m=a.some((function(e){return e.error})),s=void 0===l?c:l;return o().createElement("li",null,o().createElement(p.Z,{className:m?"gn-metadata-error":"",size:"xs",onClick:function(){return f((function(e){return!e}))}},o().createElement(i.gG,{glyph:s?"bottom":"next"})," ",r,m?o().createElement(o().Fragment,null," ",o().createElement(y.Z,{name:"exclamation"})):null),s?o().createElement("ul",null,a.map((function(e){return o().createElement("li",{key:e.name},o().createElement(p.Z,{size:"xs",className:e.error?"gn-metadata-error":"",onClick:function(){var r;return N(null===(r=t[e.name])||void 0===r?void 0:r.$id)}},e.title,e.error?o().createElement(o().Fragment,null," ",o().createElement(y.Z,{name:"exclamation"})):null))}))):null)}function x(e){var t=e.idSchema,r=e.schema,a=e.uiSchema,l=e.properties,i=e.errorSchema,u=e.formContext.title,f=I((0,n.useState)(""),2),m=f[0],s=f[1],d=l.reduce((function(e,t){var n,o,l,u=(null==r||null===(n=r.properties)||void 0===n||null===(o=n[t.name])||void 0===o?void 0:o.title)||t.name,c=(null==a?void 0:a[null==t?void 0:t.name])||{},f=(null==c?void 0:c["ui:options"])||{};if("hidden"===((null==c?void 0:c["ui:widget"])||f.widget)||!u.toLowerCase().includes((m||"").toLowerCase()))return e;var s,d=(null==f?void 0:f["geonode-ui:group"])||"General",v=e[d]||[];return P(P({},e),{},Z({},d,[].concat(function(e){if(Array.isArray(e))return C(e)}(s=v)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(s)||k(s)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[P(P({},t),{},{uiSchema:c,schema:null==r||null===(l=r.properties)||void 0===l?void 0:l[t.name],error:i[t.name],title:u})])))}),{}),v="gn-metadata-title",y=!Object.keys(d).some((function(e){return d[e].length>0}));return o().createElement("div",{className:"gn-metadata-layout"},o().createElement("ul",{className:"gn-metadata-list"},o().createElement(S,{placeholder:"gnviewer.filterMetadata",value:m,onChange:function(e){return s(e)}}),u?o().createElement("li",null,o().createElement(p.Z,{size:"xs",onClick:function(){return N(v)}},o().createElement(c.Z,{msgId:"gnviewer.metadataFor"})," ",u)):null,Object.keys(d).filter((function(e){return d[e].length>0})).map((function(e){var r=d[e];return o().createElement(A,{key:e,idSchema:t,title:e,group:r,expanded:!!m||void 0})}))),o().createElement("div",{className:"gn-metadata-groups"},u?o().createElement("div",{id:v,className:"gn-metadata-title"},o().createElement(c.Z,{msgId:"gnviewer.metadataFor"})," ",u):null,y?o().createElement("div",{className:"field"},o().createElement(c.Z,{msgId:"gnviewer.noMetadataFound"})):null,Object.keys(d).filter((function(e){return d[e].length>0})).map((function(e,t){var r=d[e];return o().createElement("div",{className:"gn-metadata-group",key:t},o().createElement("div",{className:"gn-metadata-group-title"},e),r.map((function(e,r){return o().createElement(o().Fragment,{key:"".concat(t,"_").concat(r)},e.content)})))}))))}const T={ObjectFieldTemplate:function(e){var t;return"root"===(null==e||null===(t=e.idSchema)||void 0===t?void 0:t.$id)?o().createElement(x,e):o().createElement(v.Z,e)},ErrorListTemplate:function(){return null}};var D=r(245449),F=r(818534),q=r(375875),M=r(747037),_=r.n(M);function z(e){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},z(e)}var $=["q","config"],R=["result"];function L(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function U(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?L(Object(r),!0).forEach((function(t){B(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):L(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function B(e,t,r){return(t=function(e){var t=function(e){if("object"!=z(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=z(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==z(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function K(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.includes(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.includes(r)||{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}const G={ArrayField:function(e){var t,r,n,a=e.onChange,l=e.schema,i=e.formData,u=e.idSchema,c=e.name,f=e.uiSchema,m=null==f||null===(t=f["ui:options"])||void 0===t?void 0:t["geonode-ui:autocomplete"];if(m&&"object"===(null==l||null===(r=l.items)||void 0===r?void 0:r.type)&&null!=l&&null!==(n=l.items)&&void 0!==n&&n.properties){var s,d=_()(m)?{url:m}:m,v=null==d?void 0:d.url,p=(null==d?void 0:d.queryKey)||"q",y=(null==d?void 0:d.resultsKey)||"results",b=(null==d?void 0:d.valueKey)||"id",g=(null==d?void 0:d.labelKey)||"label",h=null!==(s=null==d?void 0:d.placeholder)&&void 0!==s?s:"...";return o().createElement(o().Fragment,null,o().createElement("label",{className:"control-label",htmlFor:u.$id},(null==l?void 0:l.title)||c),null!=l&&l.description?o().createElement("p",{id:"".concat(u.$id,"__description"),className:"field-description"},null==l?void 0:l.description):null,o().createElement(F.Z,{id:u.$id,value:i.map((function(e){return{result:e,value:e[b],label:e[g]}})),multi:!0,placeholder:h,loadOptions:function(e){var t=e.q,r=e.config,n=K(e,$);return q.Z.get(v,U(U({},r),{},{params:U(U(U({},n),t&&B({},p,t)),{},{page:n.page})})).then((function(e){var t=e.data;return{isNextPageAvailable:!1,results:null==t?void 0:t[y].map((function(e){return{selectOption:{result:e,value:e[b],label:e[g]}}}))}}))},onChange:function(e){a(e.map((function(e){var t=e.result,r=K(e,R);return void 0===t?r:Object.fromEntries(Object.keys(l.items.properties).map((function(e){return[e,t[e]]})))})))}}))}return o().createElement(D.Z,e)}};var V=r(977597),W=r(904221);function H(e){return H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},H(e)}function J(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Q(e,t,r){return(t=function(e){var t=function(e){if("object"!=H(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=H(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==H(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const X=function(e){var t=e.pk,r=e.loading,f=e.error,m=e.metadata,s=e.schema,v=e.uiSchema,p=e.updateError,y=e.setLoading,b=e.setError,g=e.setUISchema,h=e.setSchema,O=e.setMetadata,E=e.setInitialMetadata,S=e.setUpdateError,j=e.setResource,w=e.updating,P=(0,n.useRef)(!1);return(0,n.useEffect)((function(){t&&(y(!0),b(!1),(0,u.RB)(t).then((function(e){g(e.uiSchema),h(e.schema),O(e.metadata),E(e.metadata),j(e.resource)})).catch((function(){b(!0)})).finally((function(){y(!1)})))}),[t]),r?o().createElement(W.Z,null):f?o().createElement(V.Z,{msgId:"gnviewer.metadataNotFound"}):m||s?o().createElement("div",{className:"gn-metadata"},o().createElement("div",{className:"gn-metadata-header"},p&&o().createElement(i.bZ,{bsStyle:"danger",style:{margin:"0.25rem 0"}},o().createElement(c.Z,{msgId:"gnviewer.metadataUpdateError"}))),o().createElement("div",{className:"gn-metadata-container"},o().createElement(l.ZP,{liveValidate:!0,formContext:{title:null==m?void 0:m.title},schema:s,widgets:d,uiSchema:v,formData:m,validator:a.ZP,templates:T,fields:G,experimental_defaultFormStateBehavior:{arrayMinItems:{populate:"never",mergeExtraDefaults:!1}},onChange:function(e,t){var r=e.formData;if(t)!function(e){S(!1),O(e)}(r);else if(!P.current){var n=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?J(Object(r),!0).forEach((function(t){Q(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):J(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},m);O(n),E(n),P.current=!0}}},o().createElement(o().Fragment,null))),w?o().createElement(W.Z,{style:{opacity:.5}}):null):null}}}]);