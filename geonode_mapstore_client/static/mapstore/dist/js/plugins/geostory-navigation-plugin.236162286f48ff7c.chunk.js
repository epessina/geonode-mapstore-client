"use strict";(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[98710],{134990:(t,e,n)=>{n.d(e,{D7:()=>u,mN:()=>s,vb:()=>l,KT:()=>d,QK:()=>f,cc:()=>p,Gx:()=>v,XH:()=>m,lX:()=>y,tP:()=>g,Dq:()=>h,LE:()=>b,SW:()=>S,si:()=>O,i2:()=>E,IY:()=>T,Zf:()=>w,ij:()=>R,Hb:()=>P,Mk:()=>C,c:()=>I,NZ:()=>D,Cx:()=>j,wb:()=>G,km:()=>_,un:()=>A,Ro:()=>k,jr:()=>Y,ZY:()=>N,EQ:()=>M,W$:()=>U,mk:()=>L,U3:()=>x,aF:()=>Z,IH:()=>B,rp:()=>z,D_:()=>H,zJ:()=>V,wJ:()=>F,OS:()=>q,YP:()=>W,Ct:()=>X,Od:()=>K,y6:()=>Q,g5:()=>$,_e:()=>J,DF:()=>tt,GD:()=>et,K0:()=>nt,kB:()=>rt,Xn:()=>ot,G5:()=>it,Vx:()=>at,RZ:()=>ct,pB:()=>ut,$A:()=>st,m7:()=>lt,YM:()=>dt,o2:()=>ft,ql:()=>pt,c0:()=>vt,Fu:()=>mt,WE:()=>yt,fD:()=>gt,EE:()=>ht});var r=n(747037),o=n.n(r),i=n(455877),a=n.n(i),c=n(192579),u="GEOSTORY:ADD",s="GEOSTORY:ADD_RESOURCE",l="GEOSTORY:CHANGE_MODE",d="GEOSTORY:CLEAR_SAVE_ERROR",f="GEOSTORY:EDIT_RESOURCE",p="GEOSTORY:EDIT_WEBPAGE",v="GEOSTORY:SCROLLING",m="GEOSTORY:LOAD_GEOSTORY",y="GEOSTORY:LOADING_GEOSTORY",g="GEOSTORY:MOVE",h="GEOSTORY:REMOVE",b="GEOSTORY:SAVE_STORY",S="GEOSTORY:SAVE_ERROR",O="GEOSTORY:STORY_SAVED",E="GEOSTORY:SELECT_CARD",T="GEOSTORY:SET_CONTROL",w="GEOSTORY:SET_RESOURCE",R="GEOSTORY:SET_CURRENT_STORY",P="GEOSTORY:SET_WEBPAGE_URL",C="GEOSTORY:TOGGLE_CARD_PREVIEW",I="GEOSTORY:TOGGLE_SETTINGS_PANEL",D="GEOSTORY:TOGGLE_SETTING",j="GEOSTORY:TOGGLE_CONTENT_FOCUS",G="GEOSTORY:UPDATE",_="GEOSTORY:UPDATE_SETTING",A="GEOSTORY:UPDATE_CURRENT_PAGE",k="GEOSTORY:REMOVE_RESOURCE",Y="GEOSTORY:SET_PENDING_CHANGES",N="GEOSTORY:SET_UPDATE_URL_SCROLL",M="GEOSTORY:UPDATE_MEDIA_EDITOR_SETTINGS",U="GEOSTORY:HIDE_CAROUSEL_ITEMS",L="GEOSTORY:ENABLE_DRAW",x="GEOSTORY:EXPORT",Z="GEOSTORY:IMPORT",B=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(t){return t};return{type:u,id:n&&n.id||a()(),path:t,position:e,element:o()(n)&&(0,c.nq)(n,r)||n}},z=function(t,e,n){return{type:s,id:t,mediaType:e,data:n}},H=function(t){return{type:l,mode:t?c.nl.EDIT:c.nl.VIEW}},V=function(t,e,n){return{type:f,id:t,mediaType:e,data:n}},F=function(t,e){return{type:m,id:t,options:e}},q=function(t){return{type:"GEOSTORY:GEOSTORY_LOADED",id:t}},W=function(){return{type:y,value:arguments.length>0&&void 0!==arguments[0]&&arguments[0],name:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"loading"}},X=function(t){return{type:"GEOSTORY:LOAD_GEOSTORY_ERROR",error:t}},K=function(t){return{type:h,path:t}},Q=function(t){return{type:S,error:t}},$=function(t,e){return{type:T,control:t,value:e}},J=function(t){return{type:E,card:t}},tt=function(t){return{type:w,resource:t}},et=function(t){return{type:O,id:t}},nt=function(t){return{type:R,story:t}},rt=function(){return{type:C}},ot=function(t){return{type:D,option:t}},it=function(){return{type:I,withSave:arguments.length>0&&void 0!==arguments[0]&&arguments[0]}},at=function(t,e){return{type:G,path:t,element:e,mode:arguments.length>2&&void 0!==arguments[2]?arguments[2]:"replace",options:arguments.length>3?arguments[3]:void 0}},ct=function(t){var e=t.sectionId,n=t.columnId;return{type:A,sectionId:e,columnId:n}},ut=function(t,e,n){return{type:g,source:t,target:e,position:n}},st=function(t,e,n,r,o){return{type:j,status:t,target:e,selector:n,hideContent:r,path:o}},lt=function(t,e){return{type:_,prop:t,value:e}},dt=function(t){return{type:P,src:t}},ft=function(t){var e=t.path;return{type:p,path:e,owner:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GEOSTORY"}},pt=function(t,e){return{type:k,id:t,mediaType:e}},vt=function(t){return{type:Y,value:t}},mt=function(t){return{type:M,mediaEditorSettings:t}},yt=function(t){return{type:v,status:t}},gt=function(t,e){return{type:U,sectionId:t,showContentId:e}},ht=function(t){return{type:L,drawOptions:t}}},81593:(t,e,n)=>{n.d(e,{Z:()=>f});var r=n(558422),o=n(945338);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function c(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){u(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function u(t,e,n){return(e=function(t){var e=function(t){if("object"!=i(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==i(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,c=[],u=!0,s=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==e);u=!0);}catch(t){s=!0,o=t}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(s)throw o}}return c}}(t,e)||l(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,e){if(t){if("string"==typeof t)return d(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(t,e):void 0}}function d(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}const f=function(t){var e,n=t.direction,i=void 0===n?"horizontal":n,a=t.deltaScroll,f=t.width,p=t.height,v=t.transition,m=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],y=s((0,r.useState)(0),2),g=y[0],h=y[1],b=s((0,r.useState)(0),2),S=b[0],O=b[1],E=(0,r.useRef)({x:0,y:0}),T=s((0,r.useState)(!1),2),w=T[0],R=T[1],P=s((0,r.useState)("start"),2),C=P[0],I=P[1],D=s((0,r.useState)(),2),j=D[0],G=D[1],_=(0,r.useRef)(),A=(0,r.useRef)({});function k(t,e){G("move:start");var n=_.current,r=n.parentNode,o=n.getBoundingClientRect(),a=r.getBoundingClientRect();if("horizontal"===i){var c=t+o.width;t<0&&c>a.width?(h(t),E.current.x=t,I("center")):t>=0?(h(0),E.current.x=0,I("start")):c<=a.width&&(h(a.width-o.width),E.current.x=a.width-o.width,I("end"))}if("vertical"===i){var u=e+o.height;e<0&&u>a.height?(O(e),E.current.y=e,I("center")):e>=0?(O(0),E.current.y=0,I("start")):u<=a.height&&(O(a.height-o.height),E.current.y=a.height-o.height,I("end"))}setTimeout((function(){G("move:end")}),v)}function Y(){var t=_.current,e=t.parentNode,n=t.getBoundingClientRect(),r=e.getBoundingClientRect();return!("horizontal"===i&&r.width>=n.width||"vertical"===i&&r.height>=n.height)}(0,r.useEffect)((function(){function t(t){t.preventDefault();var e=Y();return R(Y()),e?k(E.current.x-(t.deltaY>0?a:-a),E.current.y-(t.deltaY>0?a:-a)):null}var e=Y();R(e);var n=_.current.parentNode;return e&&k(E.current.x,E.current.y),e&&n&&n.addEventListener&&n.addEventListener("wheel",t),function(){e&&n&&n.removeEventListener&&n.removeEventListener("wheel",t)}}),[f,p].concat(function(t){if(Array.isArray(t))return d(t)}(e=m)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||l(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()));var N=(0,o.QS)({onSwiping:function(t){t.event.stopPropagation();var e=Y();return R(Y()),e?k(g-t.deltaX*t.velocity,S-t.deltaY*t.velocity):null},trackTouch:!0,trackMouse:!0});function M(t){var e=A.current[t];if(e){var n=_.current,r=(n&&n.parentNode).getBoundingClientRect(),o=e.getBoundingClientRect();if("horizontal"===i){var a=r.width,c=r.left,u=o.width,s=o.left,l=c+a,d=s+u;return c<=s&&l>=s||c<=d&&l>=d}}return!1}return{status:j,canSwipe:w,isStartControlActive:w&&("end"===C||"center"===C),isEndControlActive:w&&("start"===C||"center"===C),positionLabel:C,coordinates:{x:g,y:S},containerPropsHandlers:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).style,e=void 0===t?{}:t;return c(c({},N),{},{style:c({position:"relative",overflow:"hidden",width:"100%",height:"100%"},e)})},contentPropsHandlers:function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).style,e=void 0===t?{}:t;return{ref:_,style:c(c(c(c({position:"absolute",display:"flex"},v&&{transition:"transform ".concat(v,"ms ease 0s")}),{},{flexDirection:"horizontal"===i?"row":"column"},w&&"horizontal"===i&&{transform:"translateX(".concat(g,"px)")}),w&&"vertical"===i&&{transform:"translateY(".concat(S,"px)")}),e)}},itemPropsHandlers:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.id,n=t.onClick;return c({key:e,ref:function(t){return t&&function(t,e){A.current=c(c({},A.current),{},u({},t,e))}(e,t)}},n?{onClick:n,tabindex:M(e)?0:-1,onKeyDown:function(t){"Enter"===t.key&&n()}}:{tabindex:-1})},updateCoordinates:k,moveItemInViewById:function(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).margin,n=void 0===e?0:e,r=A.current[t];if(r){var o=_.current,a=(o&&o.parentNode).getBoundingClientRect(),c=r.getBoundingClientRect();if("horizontal"===i){var u=a.width,s=a.left,l=c.width,d=c.left;s<=d&&s+u>=d+l||k(-(d-o.getBoundingClientRect().left)+n,void 0)}}},moveToDeltaSize:function(t){k(g+t,S+t)}}}},629864:(t,e,n)=>{n.r(e),n.d(e,{default:()=>K});var r=n(558422),o=n.n(r),i=n(171703),a=n(22222),c=n(322843),u=n(192579),s=n(866113),l=n(324684),d=n(166190),f=n(80717),p=n(271418),v=n(23279),m=n.n(v),y=n(81593),g=n(580628),h=n(624847);function b(){return b=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},b.apply(null,arguments)}var S=function(t){var e=t.tabindex,n=t.text,r=t.selected,i=t.style;return o().createElement(h.Z,{tabindex:e,className:"".concat(r?"active":"btn-tray"," btn-xs btn-default"),style:i},n)};const O=(0,g.Z)((function(t){var e=t.currentPage,n=t.items,i=t.scrollTo,a=void 0===i?function(){}:i,c=t.width,s=t.height,l=t.deltaSwipeSize,d=void 0===l?200:l,f=t.transition,v=void 0===f?300:f,g=t.updateTimeDebounceTime,O=void 0===g?500:g,E=t.getItemStyle,T=void 0===E?function(){return{}}:E,w=(0,y.Z)({direction:"horizontal",width:c,height:s,transition:v,deltaScroll:d}),R=w.isStartControlActive,P=w.isEndControlActive,C=w.containerPropsHandlers,I=w.contentPropsHandlers,D=w.itemPropsHandlers,j=w.moveToDeltaSize,G=w.moveItemInViewById,_=e&&e.columns&&e.sectionId&&e.columns[e.sectionId]||e&&e.sectionId,A=function(t,n,r){return r===u.ID.CAROUSEL?e&&e.sectionId===t:n===t},k=(0,r.useRef)(null);return(0,r.useEffect)((function(){return k.current=m()((function(t){G(t,{margin:32})}),O),function(){k.current&&(k.current.cancel(),k.current=null)}}),[]),(0,r.useEffect)((function(){k.current&&(k.current.cancel(),k.current(_))}),[_]),o().createElement("div",b({},C(),{className:"ms-horizontal-menu"}),o().createElement("div",I(),n.map((function(t){var n=t.title,r=t.id,i=t.type,c=D({id:r,onClick:function(){e&&e.sectionId!==r&&a(r)}});return o().createElement("div",b({},c,{className:"ms-menu-item"}),o().createElement(S,{tabindex:"-1",id:r,text:n||"title",selected:A(r,_,i),style:T(A(r,_,i))}))}))),R&&o().createElement(h.Z,{className:"square-button-md no-border",style:{position:"absolute"},onClick:function(){return j(d)}},o().createElement(p.gG,{glyph:"chevron-left"})),P&&o().createElement(h.Z,{className:"square-button-md no-border",style:{position:"absolute",right:0},onClick:function(){return j(-d)}},o().createElement(p.gG,{glyph:"chevron-right"})))}));var E=n(45697),T=n.n(E),w=n(950966),R=n(805346),P=n(694745),C=n(478718),I=n.n(C),D=n(737275),j=n(275982),G=["tooltipPosition","hidden"];function _(t){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_(t)}function A(){return A=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},A.apply(null,arguments)}function k(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,L(r.key),r)}}function Y(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Y=function(){return!!t})()}function N(t){return N=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},N(t)}function M(t,e){return M=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},M(t,e)}function U(t,e,n){return(e=L(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function L(t){var e=function(t){if("object"!=_(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=_(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==_(e)?e:e+""}var x=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return U(t=function(t,e,n){return e=N(e),function(t,e){if(e&&("object"==_(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Y()?Reflect.construct(e,n||[],N(t).constructor):e.apply(t,n))}(this,e,[].concat(r)),"checkUnsavedChanges",(function(){t.props.renderUnsavedMapChangesDialog?t.props.onCheckMapChanges(t.goHome):(t.props.onCloseUnsavedDialog(),t.goHome())})),U(t,"goHome",(function(){t.props.goToHomePage()})),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&M(t,e)}(e,t),n=e,r=[{key:"render",value:function(){var t=this.props,e=t.tooltipPosition,n=t.hidden,r=function(t,e){if(null==t)return{};var n,r,o=function(t,e){if(null==t)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.includes(r))continue;n[r]=t[r]}return n}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.includes(n)||{}.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}(t,G),i=o().createElement(p.u,{id:"toolbar-home-button"},o().createElement(R.Z,{msgId:"gohome"}));return!n&&o().createElement(o().Fragment,null,o().createElement(w.Z,{overlay:i,placement:e},o().createElement(h.Z,A({id:"home-button",className:"square-button",bsStyle:this.props.bsStyle,onClick:this.checkUnsavedChanges,tooltip:i},I()(r,["disabled","active","block","componentClass","href","children","icon","bsStyle","className"])),o().createElement(p.gG,{glyph:this.props.icon}))),o().createElement(P.Z,{ref:"unsavedMapModal",show:this.props.displayUnsavedDialog||!1,onClose:this.props.onCloseUnsavedDialog,title:o().createElement(R.Z,{msgId:"resources.maps.unsavedMapConfirmTitle"}),buttons:[{bsStyle:"primary",text:o().createElement(R.Z,{msgId:"resources.maps.unsavedMapConfirmButtonText"}),onClick:this.goHome},{text:o().createElement(R.Z,{msgId:"resources.maps.unsavedMapCancelButtonText"}),onClick:this.props.onCloseUnsavedDialog}],fitContent:!0},o().createElement("div",{className:"ms-detail-body"},o().createElement(R.Z,{msgId:"resources.maps.unsavedMapConfirmMessage"}))))}}],r&&k(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(o().Component);U(x,"propTypes",{icon:T().string,onCheckMapChanges:T().func,onCloseUnsavedDialog:T().func,displayUnsavedDialog:T().bool,renderUnsavedMapChangesDialog:T().bool,tooltipPosition:T().string,bsStyle:T().string,hidden:T().bool}),U(x,"contextTypes",{router:T().object,messages:T().object}),U(x,"defaultProps",{icon:"home",onCheckMapChanges:function(){},onCloseUnsavedDialog:function(){},renderUnsavedMapChangesDialog:!0,tooltipPosition:"left",bsStyle:"primary",hidden:!1});const Z=(0,i.connect)(null,{goToHomePage:function(){var t=D.ZP.getMiscSetting("homePath","/");return(0,j.VF)(t)}})(x);var B=n(611847),z=n(513218),H=n.n(z);function V(t){return V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},V(t)}function F(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function q(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?F(Object(n),!0).forEach((function(e){W(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function W(t,e,n){return(e=function(t){var e=function(t){if("object"!=V(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=V(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==V(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}const X=function(t){var e,n=t.settings,r=t.scrollTo,i=void 0===r?function(){}:r,a=t.navigableItems,c=void 0===a?[]:a,u=t.currentPage,s=void 0===u?{}:u,l=t.totalItems,d=void 0===l?1:l,p=t.currentPosition,v=void 0===p?0:p,m=t.router,y=t.buttons,g=void 0===y?[]:y,h=null==n||null===(e=n.theme)||void 0===e?void 0:e.general,b=H()(h)&&h||{},S=b.fontFamily,E=b.borderColor,T=b.color,w=b.backgroundColor,R=n||{},P=R.isTitleEnabled,C=R.isLogoEnabled,I=R.isNavbarEnabled,D=g.length>0,j=m&&m.pathname&&m.search&&"true"===(0,B.vl)(m.search).showHome&&m.pathname.includes("/geostory/shared"),G=I&&(null==c?void 0:c.length)>0,_=P||C||G||D||j;return o().createElement("div",{className:"ms-geostory-navigation-bar",style:q(q({color:T,backgroundColor:w},E&&{borderBottom:"1px solid ".concat(E)}),{},{fontFamily:S})},o().createElement("div",{className:"progress-bar",key:"progress-bar",style:{backgroundColor:E}},o().createElement("div",{className:"progress-percent",style:{width:"".concat((v+1)/d*100,"%"),backgroundColor:T}})),_&&o().createElement("div",{className:"ms-geostory-navigation-tools"},o().createElement("div",{className:"ms-geostory-navigation-toolbar"},o().createElement(f.Z,{buttons:g}),j&&o().createElement(Z,{bsStyle:"default",className:"square-button-md no-border",tooltipPosition:"right",renderUnsavedMapChangesDialog:!1})),o().createElement("div",{className:"ms-geostory-navigation-elements"},G?o().createElement("div",{className:"ms-geostory-navigation-navigable-items"},o().createElement(O,{items:c,currentPage:s,scrollTo:i,getItemStyle:function(t){return t?{color:w,backgroundColor:T}:{outlineColor:T,borderColor:T}}})):null,o().createElement("div",{className:"ms-geostory-navigation-metadata"},P&&o().createElement("div",{className:"ms-geostory-navigation-title",style:{fontSize:n.storyTitleFontSize||"14px"}},n.storyTitle),C&&o().createElement("div",{className:"ms-geostory-navigation-logo"},o().createElement("img",{src:n.thumbnail&&(n.thumbnail.data||n.thumbnail.url)||"",height:32}))))))},K=(0,c.rx)("GeoStoryNavigation",{component:(0,i.connect)((0,a.zB)({mode:s.eK,settings:s.TQ,currentPage:s.PR,currentPosition:s.u5,totalItems:s.CK,navigableItems:(0,s.w)({includeAlways:!1}),pathname:l.F,search:l.y}))((function(t){var e=t.mode,n=void 0===e?u.nl.VIEW:e,r=t.currentPage,i=t.currentPosition,a=t.totalItems,c=t.settings,s=t.navigableItems,l=void 0===s?[]:s,d=t.pathname,f=t.search,p=t.items,v=(void 0===p?[]:p).filter((function(t){return t.tool})).map((function(t){return{Element:t.tool}}));return n===u.nl.VIEW?o().createElement("div",{key:"geostory-navigation",className:"ms-geostory-navigation",style:{width:"100%",position:"relative"}},o().createElement(X,{settings:c,currentPage:r,currentPosition:i,totalItems:a,scrollTo:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{behavior:"smooth"};(0,u.M1)(t,e)},navigableItems:l,router:{pathname:d,search:f},buttons:v})):null})),reducers:{geostory:d.Z}})},166190:(t,e,n)=>{n.d(e,{Z:()=>_});var r=n(227361),o=n.n(r),i=n(747037),a=n.n(i),c=n(281763),u=n.n(c),s=n(630998),l=n.n(s),d=n(313311),f=n.n(d),p=n(968630),v=n.n(p),m=n(701469),y=n.n(m),g=n(984596),h=n.n(g),b=n(545578),S=n.n(b),O=n(761868),E=n(192579),T=n(134990);function w(t){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w(t)}function R(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function P(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?R(Object(n),!0).forEach((function(e){C(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function C(t,e,n){return(e=function(t){var e=function(t){if("object"!=w(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=w(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==w(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function I(t){return function(t){if(Array.isArray(t))return D(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return D(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?D(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var j=function(t,e,n){var r=n.contents,o=n.background,i=n.id,a=n.resourceId,c=[],u=e+'{"id": "'.concat(i,'"}]');return a===t?[u]:(o&&o.resourceId===t&&c.push(u+".background"),r?r.reduce((function(e,n){return[].concat(I(e),I(j(t,u+".contents[",n)))}),c):c)},G={mode:"view",isCollapsed:!1,focusedContent:{},currentPage:{},settings:{},oldSettings:{},updateUrlOnScroll:!1};const _=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G,e=arguments.length>1?arguments[1]:void 0;switch(e.type){case T.D7:var n=e.id,r=e.path,i=e.position,c=e.element,s=(0,E.Ll)("currentStory.".concat(r),t),d=o()(t,s,[]),p=function(t,e){var n=t.length,r=0;return e||0===e||(r=n),a()(e)?r=l()(t,{id:e})+1:u()(e)&&(r=Math.min(e,t.length)),r}(d,i),m=d.slice();return m.splice(p,0,P({id:n},c)),(0,O.t8)(s,m,t);case T.mN:var g=e.id,b=e.mediaType,w=e.data;return(0,O.t8)("currentStory.resources",S()([{id:g,type:b,data:w}].concat(I(t.currentStory&&t.currentStory.resources||[])),"id"),t);case T.vb:return(0,O.t8)("mode",e.mode,t);case T.QK:var R=e.id,D=e.mediaType,_=e.data,A=(0,O.cc)("currentStory.resources",{id:R,type:D,data:_},{id:R},t);return D===E.Tr.MAP&&t.currentStory.sections.filter((function(t){return t.type!==E.ID.CAROUSEL})).reduce((function(t,e){return[].concat(I(t),I(j(R,"sections[",e)))}),[]).map((function(e){var n=(0,E.Ll)("currentStory.".concat(e,".map"),t);A=(0,O.t8)(n,void 0,A)})),A;case T.Ro:var k=e.id,Y=e.mediaType,N=(0,O.z6)("currentStory.resources",{id:k},t);return t.currentStory.sections.reduce((function(t,e){return[].concat(I(t),I(j(k,"sections[",e)))}),[]).map((function(e){var n=(0,E.Ll)("currentStory.".concat(e,".resourceId"),t);if(N=(0,O.zN)(n,N),Y===E.Tr.MAP){var r=(0,E.Ll)("currentStory.".concat(e,".map"),t);N=(0,O.zN)(r,N)}})),N;case T.lX:return(0,O.t8)("loading"===e.name?"loading":"loadFlags.".concat(e.name),e.value,(0,O.t8)("loading",e.value,t));case T.Dq:var M=e.path,U=(0,E.Ll)("currentStory.".concat(M),t),L=I(U),x=L.pop(),Z=o()(t,L);return y()(Z)?(a()(x)&&(x=parseInt(x,10)),(0,O.t8)(L,[].concat(I(Z.slice(0,x)),I(Z.slice(x+1))),t)):(0,O.zN)(U,t);case T.ij:var B,z,H,V,F,q=t.defaultSettings||{},W=e.story.settings||q,X=(null===(B=W)||void 0===B||null===(z=B.theme)||void 0===z?void 0:z.fontFamilies)||[],K=null===(H=t.currentStory)||void 0===H||null===(V=H.settings)||void 0===V||null===(F=V.theme)||void 0===F?void 0:F.fontFamilies;return K&&K.length>0&&(W=(0,O.t8)("theme.fontFamilies",S()([].concat(I(K),I(X)),"family"),W)),(0,O.t8)("currentStory",P(P({},e.story),{},{settings:W}),t);case T.i2:return(0,O.t8)("selectedCard",t.selectedCard===e.card?"":e.card,t);case T.IY:var Q=e.control,$=e.value;return(0,O.t8)("controls.".concat(Q),$,t);case T.Zf:var J=e.resource,tt=t.currentStory&&t.currentStory.settings||{};return(0,O.qC)((0,O.t8)("resource",J),(0,O.t8)("currentStory.settings.storyTitle",tt.storyTitle||J.name))(t);case T.si:case T.KT:return(0,O.zN)("errors.save",t);case T.SW:return(0,O.t8)("errors.save",h()(e.error),t);case T.Mk:return(0,O.t8)("isCollapsed",!t.isCollapsed,t);case T.NZ:var et=o()(t,"currentStory.settings.".concat(e.option));return(0,O.t8)("currentStory.settings.".concat(e.option),!et,t);case T.c:var nt=!t.isSettingsEnabled,rt=t.currentStory&&t.currentStory.settings||{};return(0,O.qC)((0,O.t8)("isSettingsEnabled",nt),(0,O.t8)("oldSettings",nt?rt:{}),(0,O.t8)("currentStory.settings",nt?P({},rt):e.withSave?rt:t.oldSettings))(t);case T.wb:var ot=e.path,it=e.mode,at=e.options,ct=e.element,ut=(0,E.Ll)("currentStory.".concat(ot),t),st=o()(t,ut);return v()(st)&&v()(ct)&&"merge"===it&&(ct=P(P({},st),ct)),y()(st)&&y()(ct)&&"merge"===it&&(ct=null!=at&&at.uniqueByKey?S()([].concat(I(st),I(ct)),at.uniqueByKey):[].concat(I(st),I(ct))),(0,O.t8)(ut,ct,t);case T.km:return(0,O.t8)("currentStory.settings.".concat(e.prop),e.value,t);case T.un:if(e.columnId){var lt=f()(t.currentStory.sections,(function(t){return f()(t.contents,{id:e.columnId})}));return lt&&f()(lt.contents,{id:e.columnId})?(0,O.t8)("currentPage",P(P({},t.currentPage),{},{columns:P(P({},t.currentPage.columns),{},C({},lt.id,e.columnId))}),t):t}return(0,O.t8)("currentPage",P(P({},t.currentPage),{},{sectionId:e.sectionId}),t);case T.Cx:var dt=e.status,ft=e.target,pt=e.selector,vt=void 0===pt?"":pt,mt=e.hideContent,yt=void 0!==mt&&mt,gt=e.path,ht=dt?{target:ft,selector:vt,hideContent:yt,path:gt}:void 0;return(0,O.t8)("focusedContent",ht,t);case T.jr:return(0,O.t8)("pendingChanges",e.value,t);case T.ZY:return(0,O.t8)("updateUrlOnScroll",e.value,t);case T.EQ:return(0,O.t8)("mediaEditorSettings",e.mediaEditorSettings,t);case T.W$:if(e.sectionId){var bt=f()(t.currentStory.sections,(function(t){return f()(t.contents,{id:e.showContentId})}));return bt&&f()(bt.contents,{id:e.showContentId})?(0,O.t8)("currentStory",P(P({},t.currentStory),{},{sections:(0,E.eI)(t.currentStory.sections,e)}),t):t}return t;case T.mk:return(0,O.t8)("drawOptions",e.drawOptions,t);default:return t}}},945338:(t,e,n)=>{n.d(e,{QS:()=>E});var r=n(558422),o=n.n(r),i=n(45697),a=n.n(i);function c(){return c=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},c.apply(this,arguments)}var u={preventDefaultTouchmoveEvent:!1,delta:10,rotationAngle:0,trackMouse:!1,trackTouch:!0},s={xy:[0,0],swiping:!1,eventData:void 0,start:void 0},l="Left",d="Right",f="Up",p="Down",v="touchstart",m="touchmove",y="touchend",g="mousemove",h="mouseup";function b(t,e){if(0===e)return t;var n=Math.PI/180*e;return[t[0]*Math.cos(n)+t[1]*Math.sin(n),t[1]*Math.cos(n)-t[0]*Math.sin(n)]}function S(t,e){var n=function(e){e.touches&&e.touches.length>1||t((function(t,n){n.trackMouse&&(document.addEventListener(g,r),document.addEventListener(h,i));var o=e.touches?e.touches[0]:e,a=b([o.clientX,o.clientY],n.rotationAngle);return c({},t,s,{eventData:{initial:[].concat(a),first:!0},xy:a,start:e.timeStamp||0})}))},r=function(e){t((function(t,n){if(!t.xy[0]||!t.xy[1]||e.touches&&e.touches.length>1)return t;var r=e.touches?e.touches[0]:e,o=b([r.clientX,r.clientY],n.rotationAngle),i=o[0],a=o[1],u=t.xy[0]-i,s=t.xy[1]-a,v=Math.abs(u),m=Math.abs(s),y=(e.timeStamp||0)-t.start,g=Math.sqrt(v*v+m*m)/(y||1);if(v<n.delta&&m<n.delta&&!t.swiping)return t;var h=function(t,e,n,r){return t>e?n>0?l:d:r>0?f:p}(v,m,u,s),S=c({},t.eventData,{event:e,absX:v,absY:m,deltaX:u,deltaY:s,velocity:g,dir:h});n.onSwiping&&n.onSwiping(S);var O=!1;return(n.onSwiping||n.onSwiped||n["onSwiped"+h])&&(O=!0),O&&n.preventDefaultTouchmoveEvent&&n.trackTouch&&e.cancelable&&e.preventDefault(),c({},t,{eventData:c({},S,{first:!1}),swiping:!0})}))},o=function(e){t((function(t,n){var r;return t.swiping&&(r=c({},t.eventData,{event:e}),n.onSwiped&&n.onSwiped(r),n["onSwiped"+r.dir]&&n["onSwiped"+r.dir](r)),c({},t,s,{eventData:r})}))},i=function(t){document.removeEventListener(g,r),document.removeEventListener(h,i),o(t)},a=function(t){if(t&&t.addEventListener){var e=[[v,n],[m,r],[y,o]];return e.forEach((function(e){var n=e[0],r=e[1];return t.addEventListener(n,r)})),function(){return e.forEach((function(e){var n=e[0],r=e[1];return t.removeEventListener(n,r)}))}}},u={ref:function(e){null!==e&&t((function(t,n){if(t.el===e)return t;var r={};return t.el&&t.el!==e&&t.cleanUpTouch&&(t.cleanUpTouch(),r.cleanUpTouch=null),n.trackTouch&&e&&(r.cleanUpTouch=a(e)),c({},t,{el:e},r)}))}};return e.trackMouse&&(u.onMouseDown=n),[u,a]}function O(t,e,n){var r={};return!e.trackTouch&&t.cleanUpTouch?(t.cleanUpTouch(),r.cleanUpTouch=null):e.trackTouch&&!t.cleanUpTouch&&t.el&&(r.cleanUpTouch=n(t.el)),c({},t,r)}function E(t){var e=t.trackMouse,n=o().useRef(c({},s,{type:"hook"})),r=o().useRef();r.current=c({},u,t);var i=o().useMemo((function(){return S((function(t){return n.current=t(n.current,r.current)}),{trackMouse:e})}),[e]),a=i[0],l=i[1];return n.current=O(n.current,r.current,l),a}var T=function(t){var e,n;function r(e){var n;return(n=t.call(this,e)||this)._set=function(t){n.transientState=t(n.transientState,n.props)},n.transientState=c({},s,{type:"class"}),n}return n=t,(e=r).prototype=Object.create(n.prototype),e.prototype.constructor=e,e.__proto__=n,r.prototype.render=function(){var t=this.props,e=t.className,n=t.style,r=t.nodeName,i=void 0===r?"div":r,a=t.innerRef,u=t.children,s=t.trackMouse,l=S(this._set,{trackMouse:s}),d=l[0],f=l[1];this.transientState=O(this.transientState,this.props,f);var p=a?function(t){return a(t),d.ref(t)}:d.ref;return o().createElement(i,c({},d,{className:e,style:n,ref:p}),u)},r}(o().PureComponent);T.propTypes={onSwiped:a().func,onSwiping:a().func,onSwipedUp:a().func,onSwipedRight:a().func,onSwipedDown:a().func,onSwipedLeft:a().func,delta:a().number,preventDefaultTouchmoveEvent:a().bool,nodeName:a().string,trackMouse:a().bool,trackTouch:a().bool,innerRef:a().func,rotationAngle:a().number},T.defaultProps=u}}]);