"use strict";(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[78225],{807691:(e,t,r)=>{r.d(t,{ZP:()=>U});var n=r(49977),o=r.n(n),i=r(66604),a=r.n(i),u=r(513218),c=r.n(u),s=r(3674),l=r.n(s),f=r(414293),d=r.n(f),b=r(557579),v=r(555927),p=r(782904),y=r(95797),m=r(197395),g=r(807878),h=r(263516),O=r(367306),w=r(274621),S=r(401757),j=r(324684),P=r(988753),E=r(727354),k=r(589919),D=r(275982),M=r(418671),T=["data"],A=["status","statusText","data","message"];function C(e){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C(e)}function N(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.includes(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.includes(r)||{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function _(e){return function(e){if(Array.isArray(e))return I(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||x(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(e,t){if(e){if("string"==typeof e)return I(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?I(e,t):void 0}}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function W(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function z(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?W(Object(r),!0).forEach((function(t){R(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):W(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function R(e,t,r){return(t=function(e){var t=function(e){if("object"!=C(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=C(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==C(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const U={openDashboardWidgetEditor:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).getState,r=void 0===t?function(){}:t;return e.ofType(b.AE,b.dm).filter((function(){return(0,O.Wy)(r())})).switchMap((function(){return o().Observable.of((0,v.D_)(!0))}))},closeDashboardWidgetEditorOnFinish:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).getState,r=void 0===t?function(){}:t;return e.ofType(b.Jm).filter((function(){return(0,O.Wy)(r())})).switchMap((function(){return o().Observable.of((0,v.D_)(!1))}))},initDashboardEditorOnNew:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).getState,r=void 0===t?function(){}:t;return e.ofType(b.AE).filter((function(){return(0,O.Wy)(r())})).switchMap((function(e){return o().Observable.of((0,b.bS)(z(z({legend:!1,mapSync:!1,cartesian:!0,yAxis:!0},e),{},{type:void 0}),{step:0}))}))},closeDashboardEditorOnExit:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).getState,r=void 0===t?function(){}:t;return e.ofType(D.nk).filter((function(){return(0,O.Wy)(r())})).filter((function(){return(0,O.i$)(r())})).switchMap((function(){return o().Observable.of((0,v.D_)(!1))}))},handleDashboardWidgetsFilterPanel:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).getState,r=void 0===t?function(){}:t;return e.ofType(b.lG).filter((function(){return(0,O.Wy)(r())})).switchMap((function(){return o().Observable.of(y.gT.apply(void 0,_((t=r(),n=(0,S.JT)(t),[n.search&&n.search.url,n.name]))),(0,g.F)((0,S.um)(r())),(0,p.Xg)("queryPanel","enabled",!0)).concat(o().Observable.race(e.ofType(g.Wm).take(1),e.ofType(p.kM).filter((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.control,r=e.property;return"queryPanel"===t&&(!r||"enabled"===r)})).take(1)).switchMap((function(e){return(e.filterObj?o().Observable.of((0,b.Rz)((0,S.Nx)(r()),e.filterObj)):o().Observable.empty()).merge(o().Observable.of((0,p.Xg)("widgetBuilder","enabled",!0)))}))).takeUntil(e.ofType(D.nk,b.dm).merge(e.ofType(p.kM).filter((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.control,r=e.property;return"widgetBuilder"===t&&0==!r})))).concat(o().Observable.of((0,p.Xg)("queryPanel","enabled",!1)));var t,n}))},filterAnonymousUsersForDashboard:function(e,t){return e.ofType(h.c8,h.Nv).filter((function(){return"/dashboard"===(0,j.F)(t.getState())})).switchMap((function(e){return function(e){if(null==e)throw new TypeError("Cannot destructure "+e)}(e),(0,w.jl)(t.getState())?o().Observable.empty():o().Observable.of((0,v.AN)({status:403}))}))},loadDashboardStream:function(e,t){var r=t.getState,n=void 0===r?function(){}:r;return e.ofType(v.zX).switchMap((function(e){var t=e.id;return(0,E.RX)(t).map((function(e){var t=e.data,r=N(e,T);return(0,v.rR)(r,(0,M.sq)(t))})).let((0,k.hP)((0,v.vM)(!0,"loading"),(0,v.vM)(!1,"loading"),(function(e){var t=window.location.href.match("dashboard-embedded")?"dashboardEmbedded":"dashboard",r=t+".errors.loading.unknownError";return 403===e.status&&(r=t+".errors.loading.pleaseLogin",(0,w.jl)(n())&&(r=t+".errors.loading.dashboardNotAccessible")),404===e.status&&(r=t+".errors.loading.dashboardDoesNotExist"),o().Observable.of((0,m.vU)({title:t+".errors.loading.title",message:r}),(0,v.AN)(z(z({},e),{},{messageId:r})))})))}))},reloadDashboardOnLoginLogout:function(e){return e.ofType(v.zX).switchMap((function(t){var r=t.id;return e.ofType(h.XP,h.Nv).switchMap((function(){return o().Observable.of((0,v.o2)(r)).delay(1e3)})).takeUntil(e.ofType(D.nk))}))},saveDashboard:function(e){return e.ofType(v.aR).exhaustMap((function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).resource,t=a()(e.attributes,(function(e){if(c()(e)){var t=null;try{t=JSON.stringify(e)}catch(e){t=null}return t}return e})),r=l()(t).filter((function(e){return"thumbnail"!==e&&"details"!==e&&!d()(t[e])}));return o().Observable.forkJoin(e.id?(0,E.id)(e):(0,E.SN)(e)).switchMap((function(n){var i,a,u=(i=n,a=1,function(e){if(Array.isArray(e))return e}(i)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,u=[],c=!0,s=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(u.push(n.value),u.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(s)throw o}}return u}}(i,a)||x(i,a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0];return(r.length>0?o().Observable.forkJoin(r.map((function(e){return(0,E.rX)({id:u,name:e,value:t[e]})}))):o().Observable.of([])).switchMap((function(){return o().Observable.of((0,v.sA)(u),e.id?(0,v.gE)(!1):(0,v.pB)(!1),e.id?(0,v.o2)(u):(0,D.VF)("/dashboard/".concat(u))).merge(o().Observable.of((0,m.$Z)({id:"DASHBOARD_SAVE_SUCCESS",title:"saveDialog.saveSuccessTitle",message:"saveDialog.saveSuccessMessage"})).delay(e.id?0:1e3))})).let((0,k.hP)((0,v.vM)(!0,"saving"),(0,v.vM)(!1,"saving")))}))})).catch((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.status,r=e.statusText,n=e.data,i=e.message,a=N(e,A);return o().Observable.of((0,v.GD)(t?{status:t,statusText:r,data:n}:i||a),(0,v.vM)(!1,"saving"))}))},exportDashboard:function(e){return e.ofType(v.Kv).switchMap((function(e){var t=e.data,r=e.fileName;return o().Observable.of([JSON.stringify(z({},t)),r,"application/json"]).do((function(e){return P.LR.apply(void 0,_(e))})).map((function(){return(0,p.Xi)("export")}))}))},importDashboard:function(e){return e.ofType(v.zV).switchMap((function(e){var t=e.file,r=e.resource;return o().Observable.defer((function(){return(0,P.zr)(t[0]).then((function(e){return e}))})).switchMap((function(e){return o().Observable.of((0,v.rR)(r,e),(0,p.Xi)("import"))})).catch((function(e){return o().Observable.of((0,m.vU)({title:"dashboard.errors.loading.title"}),(0,v.AN)(z({},e)))}))}))}}},589919:(e,t,r)=>{r.d(t,{hP:()=>s});var n=r(984596),o=r.n(n),i=r(49977),a=r.n(i);function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var c=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.startWith.apply(e,function(e){if(Array.isArray(e))return u(e)}(t=r)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||function(e,t){if(e){if("string"==typeof e)return u(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())},s=function(e,t,r){return function(n){return(r?c(n,o()(e)).catch(r):c(n,o()(e))).concat(a().Observable.from(o()(t)))}}},106862:(e,t,r)=>{r.r(t),r.d(t,{default:()=>T});var n=r(558422),o=r.n(n),i=r(867076),a=r(22222),u=r(171703),c=r(45697),s=r.n(c),l=r(322843),f=r(367306),d=r(296311),b=r(557579),v=r(555927);const p=(0,i.compose)((0,u.connect)((function(){return{}}),{backFromWizard:function(){return(0,b.Rz)("layer",void 0)}}),(0,i.withProps)((function(e){var t=e.backFromWizard;return{exitButton:{id:"dashboard-exit-button",onClick:void 0===t?function(){}:t,glyph:"arrow-left",tooltipId:"widgets.builder.wizard.backToLayerSelection"}}})));var y=r(20798),m=r(807691),g=r(24412);function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function O(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,E(n.key),n)}}function w(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(w=function(){return!!e})()}function S(e){return S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},S(e)}function j(e,t){return j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},j(e,t)}function P(e,t,r){return(t=E(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function E(e){var t=function(e){if("object"!=h(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=h(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==h(t)?t:t+""}var k=(0,i.compose)((0,u.connect)(d.Nb,{toggleConnection:b.w2,triggerShowConnections:v.G9}),(0,u.connect)(d.Tw),(0,i.withProps)((function(e){var t=e.availableDependencies;return{availableDependencies:(void 0===t?[]:t).filter((function(e){return"map"!==e}))}})),p)(y.Z),D=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t,r){return t=S(t),function(e,t){if(t&&("object"==h(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,w()?Reflect.construct(t,r||[],S(e).constructor):t.apply(e,r))}(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&j(e,t)}(t,e),r=t,(n=[{key:"componentDidMount",value:function(){this.props.onInit({servicesPermission:this.props.servicesPermission}),this.props.onMount()}},{key:"componentWillUnmount",value:function(){this.props.onUnmount()}},{key:"render",value:function(){var e=this,t=this.props.pluginCfg.selectedService||"",r=this.props.pluginCfg.services||{};return!!this.props.editing&&o().createElement("div",{className:"dashboard-editor de-builder"},o().createElement(k,{disableEmptyMap:this.props.disableEmptyMap,defaultSelectedService:t,defaultServices:r,canEditService:this.props.canEditService,enabled:this.props.editing,onClose:function(){return e.props.setEditing(!1)},catalog:this.props.catalog}))}}])&&O(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n}(o().Component);P(D,"propTypes",{id:s().string,editing:s().bool,limitDockHeight:s().bool,fluid:s().bool,zIndex:s().number,dockSize:s().number,position:s().string,onMount:s().func,onUnmount:s().func,setEditing:s().func,dimMode:s().string,src:s().string,style:s().object,pluginCfg:s().object,catalog:s().object,disableEmptyMap:s().bool,servicesPermission:s().object}),P(D,"defaultProps",{id:"dashboard-editor",editing:!1,dockSize:500,limitDockHeight:!0,zIndex:1e4,fluid:!1,dimMode:"none",position:"left",onMount:function(){},onUnmount:function(){},setEditing:function(){},servicesPermission:{editingAllowedRoles:["ALL"]}});var M=(0,u.connect)((0,a.P1)(f.i$,f.MZ,f.$c,(function(e,t,r){return{editing:e,isDashboardOpened:t,canEditService:r}})),{setEditing:v.D_,onInit:v.QT,onMount:function(){return(0,v.Nl)(!0)},onUnmount:function(){return(0,v.Nl)(!1)}})(D);const T=(0,l.rx)("DashboardEditor",{component:M,reducers:{dashboard:g.Z},epics:m.ZP})},24412:(e,t,r)=>{r.d(t,{Z:()=>d});var n=r(555927),o=r(557579),i=r(761868),a=r(984596),u=r.n(a);function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function s(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?s(Object(r),!0).forEach((function(t){f(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function f(e,t,r){return(t=function(e){var t=function(e){if("object"!=c(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==c(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{showConnections:!0,services:null,saveServiceLoading:!1},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case n.Xp:return l(l({},e),null==t?void 0:t.options);case n.BJ:return(0,i.t8)("editor.available",t.available,e);case n._y:case o.wb:case o.Jm:case o.yY:return(0,i.t8)("editing",t.editing,e);case n.vk:return(0,i.t8)("showConnections",t.show,e);case n.uI:return(0,i.t8)("showSaveModal",t.show,(0,i.t8)("saveErrors",void 0,e));case n.mg:return(0,i.t8)("showSaveAsModal",t.show,(0,i.t8)("saveErrors",void 0,e));case n.E9:var r;return l(l({},e),{},{originalData:t.data,resource:t.resource,services:null===(r=t.data)||void 0===r?void 0:r.catalogs});case n.R4:return l(l({},e),{},{originalData:void 0,resource:void 0,mode:"view",services:void 0});case n.SW:return(0,i.t8)("saveErrors",u()(t.error),e);case n.$l:return(0,i.t8)("saveErrors",void 0,e);case n.E5:var a;return l(l({},e),{},{services:e.services||t.services,selectedService:(null===(a=t.service)||void 0===a?void 0:a.key)||""});case n.s6:return(0,i.t8)("services",t.services,e);case n.B_:return l(l({},e),{},{mode:t.mode,isNew:t.isNew,saveServiceLoading:!1});case n.TA:return l(l({},e),{},{saveServiceLoading:t.loading});case n.CF:var c=t.services,s=t.service;s.isNew=!1,s.showAdvancedSettings=!1,delete s.old,c[s.key]=s;var f=s.key;return l(l({},e),{},{services:c,selectedService:f,mode:"view"});case n.js:var d,b,v=t.services,p=t.service;(v[p.key]||v[null===(d=p.old)||void 0===d?void 0:d.key])&&(delete v[p.key]||v[null===(b=p.old)||void 0===b?void 0:b.key]);var y=Object.keys(v)[0]||"";return l(l({},e),{},{services:v,mode:"view",selectedService:y});case n.CP:return(0,i.t8)("loading"===t.name?"loading":"loadFlags.".concat(t.name),t.value,(0,i.t8)("loading",t.value,e));default:return e}}}}]);