"use strict";(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[50618],{658918:(e,t,r)=>{r.d(t,{F:()=>p,X:()=>d});var n=r(375875),i=r(307887),o=r(552259),a=r(598223);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function l(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function c(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?l(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function s(e,t,r){return(t=function(e){var t=function(e){if("object"!=u(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==u(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,u=[],l=!0,c=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=o.call(r)).done)&&(u.push(n.value),u.length!==t);l=!0);}catch(e){c=!0,i=e}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw i}}return u}}(e,t)||function(e,t){if(e){if("string"==typeof e)return m(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?m(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var p=function(e){return n.Z.get(e).then((function(e){var t,n=e.data;return(t=n,Promise.all([r.e(86103),r.e(77458),r.e(45110),r.e(39512),r.e(9340),r.e(82582)]).then(r.bind(r,509340)).then((function(e){var r,n,a,u,l=e,s=void 0!==(null==t||null===(r=t.asset)||void 0===r?void 0:r.version)?t.asset.version:"1.0",m=function(e,t){var r,n,a,u,l,c;if(null!=t&&null!==(r=t.root)&&void 0!==r&&null!==(n=r.boundingVolume)&&void 0!==n&&n.region){var s=f(t.root.boundingVolume.region,4),m=s[0],p=s[1],d=s[2],b=s[3];return{bounds:{minx:(0,i.convertRadianToDegrees)(m),miny:(0,i.convertRadianToDegrees)(p),maxx:(0,i.convertRadianToDegrees)(d),maxy:(0,i.convertRadianToDegrees)(b)},crs:"EPSG:4326"}}var y=e.Matrix4.fromArray(t.root.transform||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);if(null!=t&&null!==(a=t.root)&&void 0!==a&&null!==(u=a.boundingVolume)&&void 0!==u&&u.box){var v=f(t.root.boundingVolume.box,3),g=v[0],S=v[1],h=v[2],w=e.Matrix4.multiplyByPoint(y,new e.Cartesian3(g,S,h),new e.Cartesian3),x=e.Matrix4.getMatrix3(y,new e.Matrix4),O=e.Matrix3.multiply(x,e.Matrix3.fromArray(t.root.boundingVolume.box,3,new e.Matrix3),new e.Matrix3),P=e.BoundingSphere.fromOrientedBoundingBox(new e.OrientedBoundingBox(w,O)),T=e.Cartographic.fromCartesian(P.center);if(!T)return null;var j=(0,i.convertRadianToDegrees)(T.longitude),C=(0,i.convertRadianToDegrees)(T.latitude),M=P.radius/o.Wm.degrees;return{bounds:{minx:j-M,miny:C-M,maxx:j+M,maxy:C+M},crs:"EPSG:4326"}}if(null!=t&&null!==(l=t.root)&&void 0!==l&&null!==(c=l.boundingVolume)&&void 0!==c&&c.sphere){var D=f(t.root.boundingVolume.sphere,4),E=D[0],R=D[1],I=D[2],G=D[3],L=e.Matrix4.multiplyByPoint(y,new e.Cartesian3(E,R,I),new e.Cartesian3),A=e.Matrix4.getScale(y,new e.Matrix4),V=G*e.Cartesian3.maximumComponent(A)/o.Wm.degrees,k=e.Cartographic.fromCartesian(L);if(!k)return null;var F=(0,i.convertRadianToDegrees)(k.longitude),B=(0,i.convertRadianToDegrees)(k.latitude);return{bounds:{minx:F-V,miny:B-V,maxx:F+V,maxy:B+V},crs:"EPSG:4326"}}return null}(l,t),p=(u=((null==t||null===(n=t.root)||void 0===n||null===(a=n.content)||void 0===a?void 0:a.uri)||"").split(/\./g))[u.length-1],d=null==t?void 0:t.properties;return c(c({version:s},m&&{bbox:m}),{},{format:p,properties:d})}))).then((function(e){return c({tileset:n},e)}))})).catch((function(e){return(0,a.H)(e),{tileset:{}}}))},d="3D Tiles"},603475:(e,t,r)=>{r.d(t,{hn:()=>P,ZP:()=>T});var n=r(375875),i=r(737275),o=r(472500),a=r.n(o),u=r(727418),l=r.n(u),c=r(505055),s=r.n(c),f=r(984596),m=r.n(f),p=r(307887),d=r(611847),b=r(707294);function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function v(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?v(Object(r),!0).forEach((function(t){S(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):v(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function S(e,t,r){return(t=function(e){var t=function(e){if("object"!=y(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==y(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var h={},w=function(e){var t=a().parse((0,d.eW)(e),!0);return a().format(l()({},t,{search:null},{query:l()({SERVICE:"WMTS",VERSION:"1.0.0",REQUEST:"GetCapabilities"},t.query)}))},x=function(e,t,r,n,i){for(var o=e.Capabilities.Contents,a=(0,b.G6)(e),u=(0,b.s5)(e),c=o.TileMatrixSet&&m()(o.TileMatrixSet)||[],s=[],f=c.length,d=0;d<f;d++)s.push((0,p.getEPSGCode)(c[d]["ows:SupportedCRS"]));var y=o.Layer,v=m()(y).filter((function(e){return!n||-1!==e["ows:Identifier"].toLowerCase().indexOf(n.toLowerCase())||e["ows:Title"]&&-1!==e["ows:Title"].toLowerCase().indexOf(n.toLowerCase())}));return{numberOfRecordsMatched:v.length,numberOfRecordsReturned:Math.min(r,v.length),nextRecord:t+Math.min(r,v.length)+1,records:v.filter((function(e,n){return n>=t-1&&n<t-1+r})).map((function(e){return l()({},e,{SRS:s,TileMatrixSet:c,queryable:!!(0,b.b4)(a,"GetFeatureInfo","KVP"),requestEncoding:u,style:(0,b.EN)(e),format:(0,b.JY)(e),formats:m()(e.Format),GetTileURL:(0,b.b4)(a,"GetTile",u),capabilitiesURL:i})}))}},O={parseUrl:w,getRecords:function(e,t,r,o){var a=h[e];return a&&(new Date).getTime()<a.timestamp+1e3*((0,i.u8)("cacheExpire")||60)?new Promise((function(n){n(x(a.data,t,r,o,e))})):n.Z.get(w(e)).then((function(n){var i;return s().parseString(n.data,{explicitArray:!1},(function(e,t){i=t})),h[e]={timestamp:(new Date).getTime(),data:i},x(i,t,r,o,e)}))},getCapabilities:function(e,t){null!=t&&t.force&&h[e]&&delete h[e];var r=h[e];return r&&(new Date).getTime()<r.timestamp+1e3*((0,i.u8)("cacheExpire")||60)?new Promise((function(e){e(r.data)})):n.Z.get(w(e)).then((function(t){var r;return s().parseString(t.data,{explicitArray:!1},(function(e,t){r=t})),h[e]={timestamp:(new Date).getTime(),data:r},r}))},textSearch:function(e,t,r,n){return O.getRecords(e,t,r,n)},reset:function(){Object.keys(h).forEach((function(e){delete h[e]}))}},P=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2?arguments[2]:void 0;return O.getCapabilities(e,{force:null==r?void 0:r.force}).then((function(e){var r,n,i,o,a=t.split(":"),u=m()((null==e||null===(r=e.Capabilities)||void 0===r||null===(n=r.Contents)||void 0===n?void 0:n.Layer)||[]).find((function(e){return e["ows:Identifier"]===a[1]||e["ows:Identifier"]===t})),l=m()((null==u?void 0:u.TileMatrixSetLink)||[]).map((function(e){return e.TileMatrixSet})),c=m()((null==e||null===(i=e.Capabilities)||void 0===i||null===(o=i.Contents)||void 0===o?void 0:o.TileMatrixSet)||[]).filter((function(e){return l.includes(e["ows:Identifier"])})),s=c.map((function(e){var t=e.TileMatrix.map((function(e){return e.TopLeftCorner.split(" ").map(parseFloat)})),r=e.TileMatrix.map((function(e){return[parseFloat(e.TileWidth),parseFloat(e.TileHeight)]})),n=t[0],i=r[0],o=t.every((function(e){return n[0]===e[0]&&n[1]===e[1]})),a=r.every((function(e){return i[0]===e[0]&&i[1]===e[1]}));return g(g({id:e["ows:Identifier"],crs:(0,p.getEPSGCode)(e["ows:SupportedCRS"]),scales:e.TileMatrix.map((function(e){return parseFloat(e.ScaleDenominator)}))},o?{origin:n}:{origins:t}),a?{tileSize:i}:{tileSizes:r})}));return{tileMatrixSets:c,tileMatrixSetLinks:l,tileGrids:s,styles:m()((null==u?void 0:u.Style)||[]).map((function(e){return e["ows:Identifier"]})),formats:m()((null==u?void 0:u.Format)||[])}}))};const T=O}}]);